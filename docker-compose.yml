version: '3'
services:
 mysqldb:
  image: mysqldb
  container_name: db
  restart: always
  environment:
   MYSQL_DATABASE: 'achatdb'
   MYSQL_ROOT_PASSWORD: 'root'
  ports:
   - '3306:3306'
  volumes:
   - db:/var/lib/mysql
 phpmyadmin:
  image: phpmyadmin/phpmyadmin
  restart: unless-stopped
  environment:
   PMA_ARBITRARY: 1
   PMA_HOST: mysqldb
  depends_on:
  - mysqldb
  ports:
   - '8068:80'
 spring_app:
  image: mejriali/achat-1.1:31
  container_name: achat
  restart: on-failure
  ports:
   - 8089:8089
  depends_on:
   - mysqldb
  volumes:
   - achat_cache:/sonar-nexus/achatapp-cache



volumes:
 db:
 achat_cache: